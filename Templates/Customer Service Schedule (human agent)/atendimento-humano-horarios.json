{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"a5f855b2-7344-44ad-bf8b-75bccd63d288","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":false,"position":"right"},"$invalid":false},"$invalid":false,"$$hashKey":"object:9132"}],"$conditionOutputs":[{"stateId":"welcome","conditions":[{"source":"input","comparison":"matches","values":[".*"],"$$hashKey":"object:9158"}],"$connId":"con_3","$invalid":false,"$$hashKey":"object:9138"}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"id":"onboarding","root":true,"$position":{"top":"118px","left":"342px"},"$title":"In√≠cio","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"95b10ba8-e351-4d16-9b10-ce14961cb1fd","type":"text/plain"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"error","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$connId":"con_8","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"id":"fallback","$position":{"top":"587px","left":"358px"},"$title":"Exce√ß√µes","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000000","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000000","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$$hashKey":"object:450","$invalid":false},{"action":{"type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000001","type":"text/plain","content":"Ol√° {{contact.name}}!\n√â um prazer falar com voc√™ üòä"},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000001","type":"text/plain","content":"Ol√° {{contact.name}}!\n√â um prazer falar com voc√™ üòä"},"editable":true,"deletable":true,"position":"left"}},"$$hashKey":"object:451","$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"cf8c9892-92a7-4a39-b169-9b8f5f7ef7a4","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:452","$invalid":false}],"$conditionOutputs":[{"stateId":"0a2d7b49-9df3-4e94-9714-eefd7ed84a6e","$connId":"con_13","conditions":[{"source":"input","comparison":"matches","values":[".*"],"$$hashKey":"object:6543"}],"$invalid":false,"$$hashKey":"object:6523"}],"$enteringCustomActions":[{"type":"TrackEvent","$title":"TrackAnyAttendance","$invalid":false,"settings":{"extras":{},"category":"AtendimentosTotais","action":"AtendimentosTotais"},"$$hashKey":"object:3410"}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"id":"welcome","$position":{"top":"250px","left":"342px"},"$title":"1.0 - Boas vindas","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4369"},{"action":{"type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000003","type":"text/plain","content":"Desculpe, n√£o consegui entender!"},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000003","type":"text/plain","content":"Desculpe, n√£o consegui entender!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:4370"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"a1f34699-dd5c-43b6-8345-fde58dc32c0d","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$invalid":false,"$$hashKey":"object:4371"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"id":"error","$position":{"top":"587px","left":"596px"},"$title":"Erro padr√£o","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0a2d7b49-9df3-4e94-9714-eefd7ed84a6e":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"7fb24b66-f182-4a6b-82ec-17cd0d87cf16","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:1019","$invalid":false}],"$conditionOutputs":[{"stateId":"3c555d39-68eb-466b-9063-6adeb01132fc","$connId":"con_18","conditions":[{"source":"context","comparison":"equals","values":["false"],"$$hashKey":"object:3446","variable":"isWorkTime"}],"$invalid":false,"$$hashKey":"object:3423"},{"stateId":"95118c04-1f32-40df-b1b0-54fb24fa2fc7","$connId":"con_23","conditions":[{"source":"context","comparison":"equals","values":["true"],"$$hashKey":"object:3519","variable":"isWorkTime"}],"$invalid":false,"$$hashKey":"object:3424"}],"$enteringCustomActions":[{"type":"ExecuteScript","$title":"SetWorkSchedule","$invalid":false,"settings":{"function":"run","source":"/**\n            * All input variables needs to be passed as function param;\n            * Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n            * Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n            **/\nfunction run() {\n  let workSchedule = [\n    {\n      num: 0,\n      name: \"Sunday\",\n      portugueseName: \"Domingo\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"12:00\"\n        }\n      ]\n    },\n    {\n      num: 1,\n      name: \"Monday\",\n      portugueseName: \"Segunda-feira\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"12:00\"\n        },\n        {\n          start: \"13:00\",\n          end: \"15:00\"\n        },\n        {\n          start: \"15:30\",\n          end: \"18:00\"\n        }\n      ]\n    },\n    {\n      num: 2,\n      name: \"Tuesday\",\n      portugueseName: \"Ter√ßa-feira\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"18:00\"\n        }\n      ]\n    },\n    {\n      num: 3,\n      name: \"Wednesday\",\n      portugueseName: \"Quarta-feira\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"12:00\"\n        },\n        {\n          start: \"13:00\",\n          end: \"18:00\"\n        }\n      ]\n    },\n    {\n      num: 4,\n      name: \"Thursday\",\n      portugueseName: \"Quinta-feira\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"12:00\"\n        },\n        {\n          start: \"13:00\",\n          end: \"18:00\"\n        }\n      ]\n    },\n    {\n      num: 5,\n      name: \"Friday\",\n      portugueseName: \"Sexta-feira\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"12:00\"\n        },\n        {\n          start: \"13:00\",\n          end: \"18:00\"\n        }\n      ]\n    },\n    {\n      num: 6,\n      name: \"Saturday\",\n      portugueseName: \"S√°bado\",\n      workTime: [\n        {\n          start: \"8:30\",\n          end: \"12:00\"\n        }\n      ]\n    }\n  ];\n\n  return JSON.stringify(workSchedule); //Return value will be saved as \"Return value variable\" field name\n}","inputVariables":[],"outputVariable":"workSchedule"},"conditions":[]},{"type":"ExecuteScript","$title":"CheckWorkTime","$invalid":false,"settings":{"function":"run","source":"\n//Default BLiP TimeZoneOffset = S√£o Paulo (GMT-3)\nvar DEFAULT_OFFSET = 3;\n\n\n// Receive the variables as parameters\nfunction run(offset, weekSchedule) {\n  offset = parseInt(offset) + DEFAULT_OFFSET;\n\n   weekSchedule = JSON.parse(weekSchedule);\n\n  let today = nowUTC(offset);\n\n  if (isWorkDay(today, weekSchedule)) {\n    let todaySchedule = getTodaySchedule(weekSchedule, today);\n    let intervalTime = getIntervalTime(todaySchedule, offset);\n\n    return checkTime(intervalTime, today);\n  }\n\n  return false;\n}\n\nfunction getIntervalTime(todaySchedule, offset) {\n  let intervalTime = [];\n  for (let i = 0; i < todaySchedule.workTime.length; i++) {\n    intervalTime.push({\n      start: utcDate(todaySchedule.workTime[i].start, offset),\n      end: utcDate(todaySchedule.workTime[i].end, offset)\n    });\n  }\n\n  return intervalTime;\n}\n\nfunction checkTime(intervalTime, today) {\n  for (let i = 0; i < intervalTime.length; i++) {\n    if (today - intervalTime[i].start > 0 && intervalTime[i].end - today > 0)\n      return true;\n  }\n  return false;\n}\n\nfunction getTodaySchedule(weekSchedule, today) {\n  for (let i = 0; i < weekSchedule.length; i++) {\n    if (weekSchedule[i].num == today.getDay()) return weekSchedule[i];\n  }\n}\n\n//Get now UTC Date\nfunction nowUTC(offset) {\n  let now = new Date();\n  let utc_timestamp = Date.UTC(\n    now.getUTCFullYear(),\n    now.getUTCMonth(),\n    now.getUTCDate(),\n    now.getUTCHours(),\n    now.getUTCMinutes(),\n    now.getUTCSeconds(),\n    now.getUTCMilliseconds()\n  );\n\n  return new Date(utc_timestamp + offset * 3600 * 1000);\n}\n\n//Get UTC Date\nfunction utcDate(timeString, offset) {\n  let now = new Date();\n\n  let hour = getValueByString(\"hour\", timeString);\n  let minutes = getValueByString(\"minutes\", timeString);\n\n  hour += DEFAULT_OFFSET;\n\n  let utc_timestamp = Date.UTC(\n    now.getUTCFullYear(),\n    now.getUTCMonth(),\n    now.getUTCDate(),\n    hour,\n    minutes,\n    0,\n    0\n  );\n  return new Date(utc_timestamp + offset * 3600 * 1000);\n}\n\n//Get hour/minute by string with pattern HH:mm\nfunction getValueByString(type, timeString) {\n  if (type === \"hour\") {\n    return parseInt(timeString.substring(0, timeString.indexOf(\":\")));\n  } else if (type === \"minutes\") {\n    return parseInt(\n      timeString.substring(timeString.indexOf(\":\") + 1, timeString.length)\n    );\n  }\n\n  return 0;\n}\n\n//Get if today is a work day\nfunction isWorkDay(today, workDays) {\n  for (let i = 0; i < workDays.length; i++) {\n    if (workDays[i].num == today.getDay().toString()) return true;\n  }\n  return false;\n}\n","inputVariables":["config.dateTimeOffset","workSchedule"],"outputVariable":"isWorkTime"},"$$hashKey":"object:3809","conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"id":"0a2d7b49-9df3-4e94-9714-eefd7ed84a6e","root":false,"$title":"2.0 - Verifica Hor√°rio Atendimento","$position":{"top":"239px","left":"590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"95118c04-1f32-40df-b1b0-54fb24fa2fc7":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"425aa5d2-fcf9-4094-a52c-73917f47875c","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:1162","$invalid":false}],"$conditionOutputs":[{"stateId":"143e0124-ec4e-462d-8369-efc61791afe6","$connId":"con_28","conditions":[{"source":"context","comparison":"equals","values":["false"],"$$hashKey":"object:15320","variable":"hasAttendant"}],"$invalid":false,"$$hashKey":"object:15309"},{"stateId":"4c0d9be0-bd3d-4e72-b105-a2ac741e5149","$connId":"con_33","conditions":[{"source":"context","comparison":"equals","values":["true"],"$$hashKey":"object:29949","variable":"hasAttendant"}],"$invalid":false,"$$hashKey":"object:29938"}],"$enteringCustomActions":[{"type":"ProcessHttp","$title":"CheckAgentsAvailability","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"Key {{config.token}}"},"method":"POST","body":"{\n  \"id\": \"{{random.guid}}\",\n  \"from\": \"{{application.identifier}}@{{application.domain}}\",  \"to\": \"postmaster@desk.msging.net\",\n  \"method\": \"get\",\n  \"uri\": \"/attendants\"\n}","uri":"https://msging.net/commands","responseStatusVariable":"status","responseBodyVariable":"result"},"$$hashKey":"object:10425"},{"type":"ExecuteScript","$title":"HandleCheckRequest","$invalid":false,"settings":{"function":"run","source":"// Receive the variables as parameters\nfunction run(result) {\n    result = JSON.parse(result);\n    \n    let hasAttendant = false;\n\n    if(result.resource && result.resource.total >= 1){\n        hasAttendant  = result.resource.items.some(function(attendant){\n            return attendant.status === 'Online';\n        });\n    }\n    return hasAttendant;\n}","inputVariables":["result"],"outputVariable":"hasAttendant"},"$$hashKey":"object:11605","conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"id":"95118c04-1f32-40df-b1b0-54fb24fa2fc7","root":false,"$title":"3.0 - Verifica Disponibilidade Atendentes","$position":{"top":"229px","left":"839px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3c555d39-68eb-466b-9063-6adeb01132fc":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"504721a0-3d44-4e95-82cc-dd33718b906a","type":"text/plain","content":"{{message}} "},"$cardContent":{"document":{"id":"504721a0-3d44-4e95-82cc-dd33718b906a","type":"text/plain","content":"{{message}} "},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:7179"},{"action":{"type":"SendMessage","settings":{"id":"572270ea-ed3c-4d1f-ba79-c695b9a7b247","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"572270ea-ed3c-4d1f-ba79-c695b9a7b247","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:18982"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"fd1c385b-7adc-4efb-b829-3b137d4e97c0","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:1457","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"type":"TrackEvent","$title":"TrackRequestsOutWorkTime","$invalid":false,"settings":{"extras":{},"category":"Solicita√ß√£o","action":"Fora Horario Atendimento"},"$$hashKey":"object:2108","conditions":[]},{"type":"ExecuteScript","$title":"BuildMessage","$invalid":false,"settings":{"function":"run","source":"/**\n            * All input variables needs to be passed as function param;\n            * Objects received as param needs to be parsed. Ex.: JSON.parse(inputVariable1);\n            * Objects returned needs to be stringfied. Ex.: JSON.stringify(inputVariable1);\n            **/\nvar DEFAULT_MESSAGE = \"Infelizmente, n√£o realizamos atendimento hoje.\";\n\nfunction run(workSchedule, day) {\n    workSchedule = JSON.parse(workSchedule);\n    let today = getToday(workSchedule, day);\n    return checkToday(today); //Return value will be saved as \"Return value variable\" field name\n}\n\n\nfunction getToday(workSchedule, day) {\n    let today = workSchedule.filter(e => {\n        return e.name === day;\n    });\n    return today;\n}\n\nfunction checkToday(today) {\n    if (today.length > 0) return buildMessage(today[0]);\n    else return DEFAULT_MESSAGE;\n}\n\nfunction buildMessage(today) {\n    let patternMessage =\n        \"Infelizmente n√£o estamos no nosso hor√°rio de atendimento. \" +\n        today.portugueseName +\n        \" nosso hor√°rio de atendimento √© de \";\n\n    today.workTime.forEach(e => {\n        patternMessage += e.start + \" a \" + e.end + \", \";\n    });\n\n    patternMessage += \"por gentileza, retorne neste hor√°rio.\";\n    return patternMessage;\n}\n","inputVariables":["workSchedule","calendar.dayOfWeek"],"outputVariable":"message"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"0a2d7b49-9df3-4e94-9714-eefd7ed84a6e","$invalid":false},"id":"3c555d39-68eb-466b-9063-6adeb01132fc","root":false,"$title":"2.1 - Fora do Hor√°rio de Atendimento","$position":{"top":"394px","left":"590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"desk:b69ef3a2-9983-48f8-9d40-16bad478a460":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"b04c3ac0-5b0c-4f61-ade4-9adbd31ae1fc","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:2535","$invalid":false}],"$conditionOutputs":[{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedAttendant"]}],"$$hashKey":"object:2539","$invalid":false,"stateId":"2b9bfb62-6346-4762-99ab-733d0c00d1a3","$connId":"con_38"},{"$isDeskOutput":true,"conditions":[{"source":"context","variable":"input.type","comparison":"equals","values":["application/vnd.iris.ticket+json"]},{"source":"context","variable":"input.content@status","comparison":"equals","values":["ClosedClient"]}],"$$hashKey":"object:2540","$invalid":false,"stateId":"2b9bfb62-6346-4762-99ab-733d0c00d1a3","$connId":"con_43"}],"$enteringCustomActions":[{"type":"ForwardMessageToDesk","settings":{},"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","$invalid":false},"id":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","root":false,"$title":"4.0 - Atendimento humano","$position":{"top":"239px","left":"1350px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2b9bfb62-6346-4762-99ab-733d0c00d1a3":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"b950d0ee-cd9b-4aec-949b-02b8242cbeea","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b950d0ee-cd9b-4aec-949b-02b8242cbeea","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:8877"},{"action":{"type":"SendMessage","settings":{"id":"90ec55b8-aadd-4f92-bf1a-dec84eb60244","type":"text/plain","content":"Atendimento finalizado!"},"$cardContent":{"document":{"id":"90ec55b8-aadd-4f92-bf1a-dec84eb60244","type":"text/plain","content":"Atendimento finalizado!"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:8878"},{"action":{"type":"SendMessage","settings":{"id":"8b33aca6-bda4-4dec-8a22-5b5f51a2ec53","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8b33aca6-bda4-4dec-8a22-5b5f51a2ec53","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:8323"},{"action":{"type":"SendMessage","settings":{"id":"6bfaa60e-ce61-43fb-978e-80b1c5a15d8d","type":"text/plain","content":"Em uma escala de 0 a 10, onde 0 √© nada satisfeito e 10 √© totalmente satisfeito, qual nota voc√™ d√° para esse atendimento?"},"$cardContent":{"document":{"id":"6bfaa60e-ce61-43fb-978e-80b1c5a15d8d","type":"text/plain","content":"Em uma escala de 0 a 10, onde 0 √© nada satisfeito e 10 √© totalmente satisfeito, qual nota voc√™ d√° para esse atendimento?"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:8324"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"64b7d83d-e2f4-4df4-8ad4-c9489c0f15f9","type":"text/plain","textContent":"Entrada do usu√°rio","content":"score"},"editable":false,"deletable":true,"position":"right"},"$invalid":false,"variable":"score"},"$$hashKey":"object:2716","$invalid":false},{"action":{"type":"SendMessage","settings":{"id":"a0151d70-16b1-455c-9534-a15acac75993","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}"}},"$cardContent":{"document":{"id":"a0151d70-16b1-455c-9534-a15acac75993","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:31269"},{"action":{"type":"SendMessage","settings":{"id":"dea1d712-9374-4990-8f99-5f38a06d5263","type":"text/plain","content":"Obrigado pela participa√ß√£o.","metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}"}},"$cardContent":{"document":{"id":"dea1d712-9374-4990-8f99-5f38a06d5263","type":"text/plain","content":"Obrigado pela participa√ß√£o."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:31270"}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[{"type":"ExecuteScript","$title":"NormalizeScore","$invalid":false,"settings":{"function":"run","source":"// Receive the variables as parameters\nfunction run(score) {\n    if(isNumeric(score)){\n       score = parseInt(score);\n       if(score < 0) return 0;\n       if(score > 10) return 10;\n       return score;\n    }\n    return \"Outro\";\n}\n\n//check if a string has a number\nfunction isNumeric(num){\n  return !isNaN(num)\n}","inputVariables":["score"],"outputVariable":"score"},"$$hashKey":"object:10000"},{"type":"TrackEvent","$title":"TrackScoreValue","$invalid":false,"settings":{"extras":{},"category":"Score","action":"{{score}}"},"$$hashKey":"object:31556"}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"id":"2b9bfb62-6346-4762-99ab-733d0c00d1a3","root":false,"$title":"5.0 - Nota de atendimento","$position":{"top":"239px","left":"1602px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"143e0124-ec4e-462d-8369-efc61791afe6":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"95011b31-5279-4d98-968d-b5af3c6d6b26","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"95011b31-5279-4d98-968d-b5af3c6d6b26","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:14938"},{"action":{"type":"SendMessage","settings":{"id":"2d2d011a-e3d5-4807-a347-d6cd9b3f43c8","type":"text/plain","content":"Desculpe, n√£o temos atendentes dispon√≠veis no momento. Por favor, tente novamente mais tarde."},"$cardContent":{"document":{"id":"2d2d011a-e3d5-4807-a347-d6cd9b3f43c8","type":"text/plain","content":"Desculpe, n√£o temos atendentes dispon√≠veis no momento. Por favor, tente novamente mais tarde."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:14939"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"76137ac2-42ab-4ee9-aef7-743cb9160a98","type":"text/plain","textContent":"Entrada do usu√°rio","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:14387","$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"type":"TrackEvent","$title":"TrackRequestsWithoutAgent","$invalid":false,"settings":{"extras":{},"category":"Solicita√ß√£o","action":"Sem Atendente"},"$$hashKey":"object:2563","conditions":[]},{"type":"TrackEvent","$title":"TrackAbsoluteNotAvailableAgents","$invalid":false,"settings":{"extras":{},"category":"Atendentes Indispon√≠veis","action":"Atendentes Indispon√≠veis"},"$$hashKey":"object:2135","conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"0a2d7b49-9df3-4e94-9714-eefd7ed84a6e","$invalid":false},"id":"143e0124-ec4e-462d-8369-efc61791afe6","root":false,"$title":"3.2 - Nenhum atendente dispon√≠vel","$position":{"top":"390px","left":"1000px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4c0d9be0-bd3d-4e72-b105-a2ac741e5149":{"$contentActions":[{"action":{"type":"SendMessage","settings":{"id":"adaea5c6-03e0-4ba5-9ef6-e1e3f9e9067e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"adaea5c6-03e0-4ba5-9ef6-e1e3f9e9067e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:28804"},{"action":{"type":"SendMessage","settings":{"id":"04835382-935c-4372-8778-69b4b0912d60","type":"text/plain","content":"A partir de agora um de nossos atendentes vai respond√™-lo."},"$cardContent":{"document":{"id":"04835382-935c-4372-8778-69b4b0912d60","type":"text/plain","content":"A partir de agora um de nossos atendentes vai respond√™-lo."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:28805"},{"action":{"type":"SendMessage","settings":{"id":"96272fb2-b301-4611-921b-69aa74791395","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"96272fb2-b301-4611-921b-69aa74791395","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:30858"},{"action":{"type":"SendMessage","settings":{"id":"8f63c111-4933-4e07-a9be-574ca9d0fbda","type":"text/plain","content":"Como podemos ajud√°-lo?"},"$cardContent":{"document":{"id":"8f63c111-4933-4e07-a9be-574ca9d0fbda","type":"text/plain","content":"Como podemos ajud√°-lo?"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:30859"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"86667929-c0a7-473d-b066-fbed10260d73","type":"text/plain","content":"Entrada do usu√°rio"},"editable":false,"deletable":true,"position":"right"},"$invalid":false},"$$hashKey":"object:28400","$invalid":false}],"$conditionOutputs":[{"stateId":"desk:b69ef3a2-9983-48f8-9d40-16bad478a460","$connId":"con_48","conditions":[{"source":"input","comparison":"matches","values":[".*"],"$$hashKey":"object:30637"}],"$invalid":false,"$$hashKey":"object:30617"}],"$enteringCustomActions":[{"type":"TrackEvent","$title":"TrackAttendances","$invalid":false,"settings":{"extras":{},"category":"AtendimentosRealizados","action":"AtendimentosRealizados"},"$$hashKey":"object:1433"}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"id":"4c0d9be0-bd3d-4e72-b105-a2ac741e5149","root":false,"$title":"3.1 - Atendente dispon√≠vel","$position":{"top":"239px","left":"1112px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}